{
  "hash": "1f3debbb9f66dba1f4ff57d34345ab2b",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Cuál es el agente precipitante más usado en la cristalización de la lisozima?\"\nauthor: \"Francisco Murphy Pérez\"\ndate: \"2023-11-23\"\ncategories: [código, análisis, R]\n---\n\n\n## Obtención de datos\n\nSabemos de antemano que la lisozima de clara de huevo de gallina se ha cristalizado en múltiples ocasiones. Los detalles de los experimentos de cristalización, se pueden obtener del PDB con una simple búsqueda avanzada, como se muestra en la siguiente imagen.\n\n![Lisozimas cristalizadas en el PDB.](busqueda_avanzada_mod.png)\n\nLos resultados de la búsqueda avanzada, al 23 de noviembre del 2023, indican que la lisozima se ha cristalizado al menos 1116 veces. Los filtros usados para obtener estos datos fueron:\n\n-   El identificador `uniprot` de la entidad cristalizada tiene que ser igual a `P00698` (el cual corresponde al identificador de la lisozima de clara de huevo de gallina en la base de datos [uniprot](https://www.uniprot.org/)).\n-   El experimento corresponde a difracción de rayos-X.\n\nA partir de los resultados obtenidos de la búsqueda avanzada, se crea un archivo `.csv` que contenga los detalles del procedimiento de cristalización para cada entrada.\n\n## Limpieza de datos\n\nNo todas las entradas tienen datos útiles. Por ejemplo:\n\n``` {style=\"background-color: rgba(255, 255, 128, .5);\"}\n\"1AZF\",\"pH 4.6\"\n\"1HEL\"\n\"1KIP\",\"FREE TEXT GOES HERE.\"\n\"1UIC\",\"50 MM ACETATE AT PH 4.7 CONTAINING 0.9 M NACL\"\n\"1VDQ\",\"batch method\"\n```\n\nDe estas entradas solo la cuarta es útil para este análisis, dado que tiene la concentración y la fórmula química del precipitante usado. Así, el primer paso en la limpieza de datos es eliminar las entradas que no contengan información útil.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Lee el archivo `.csv`\ndf <- read_csv(\"rcsb_pdb_custom_report_20231120172315.csv\")\n\n# Convierte todo a minúsculas\ndf$crystal_growth_procedure <- tolower(df$crystal_growth_procedure)\n\n# Elimina entradas inútiles\ndf2 <- df %>% \n  filter(!is.na(crystal_growth_procedure)) %>%\n  filter(!str_detect(crystal_growth_procedure, \"^ph\"))\n\n# Reemplaza 'nacl' por 'sodium chloride' \ndf2$crystal_growth_procedure <- str_replace_all(df2$crystal_growth_procedure, \"nacl\", \"sodium chloride\")\n\n# Reemplaza 'nano3' por 'sodium nitrate' \ndf2$crystal_growth_procedure <- str_replace_all(df2$crystal_growth_procedure, \"nacl\", \"sodium chloride\")\n```\n:::\n\n\nAhora, como ejemplo, obtiene el porcentaje de entradas en las que está escrito 'sodium chloride', 'sodium nitrate' y también, el porcentaje de las entradas que no resultaron útiles.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Define las entradas totales\nentradas_tot <- nrow(df)\n\n# Obtiene el número de entradas restantes\nentradas_res <- nrow(df2)\n\n# Obtiene el número de entradas que contienen 'sodium chloride'\nentradas_nacl <- sum(str_detect(df2$crystal_growth_procedure, 'sodium chloride'))\n\n# Obtiene el número de entradas que contienen 'sodium nitrate'\nentradas_nano3 <- sum(str_detect(df2$crystal_growth_procedure, 'sodium nitrate'))\n\n# Obtiene porcentajes\nporc_nacl <- round(entradas_nacl/entradas_tot*100, digits = 2)\nporc_nano3 <- round(entradas_nano3/entradas_tot*100, digits = 2)\nporc_nada <- round((entradas_tot-entradas_res)/entradas_tot*100, digits = 2)\nporc_otros <- round((entradas_res-(entradas_nacl+entradas_nano3))/entradas_tot*100, digits = 2)\n```\n:::\n\n\n## Visualización de datos\n\nUna gráfica de *pie* para visualizar los porcentajes resultantes.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Crea el data frame\nporcentajes <- tibble(Entradas = c(\"Cloruro de sodio\", \"Nitrato de sodio\", \"No útiles\", \"Restantes\" ), porcentaje = c(porc_nacl, porc_nano3, porc_nada, porc_otros))\n\n# Crea la gráfica\nggplot(porcentajes, aes(x = \"\", y = porcentaje, fill = Entradas)) +\n  geom_col(color = \"black\") +\n  geom_text(aes(label = paste0(porcentaje, \" %\")),\n            color=\"black\",\n            position = position_stack(vjust = 0.4)) +\n  coord_polar(theta = \"y\") +\n  theme_void() +\n  guides(fill = guide_legend(title = \"Entradas\")) + \n  scale_fill_brewer(palette = \"Greys\") +\n  theme(legend.position = \"bottom\")  \n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}